<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>魔法天气播报员</title>
  <style>
    body {
      margin: 0;
      font-family: "Arial", sans-serif;
      background: linear-gradient(to bottom, #87ceeb, #f0f9ff);
      color: #333;
      text-align: center;
      padding: 20px;
    }
    header {
      font-size: 1.8em;
      font-weight: bold;
      margin-bottom: 20px;
    }
    #weather-box {
      background: white;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .section {
      margin-top: 20px;
    }
    .placeholder {
      background: #eee;
      border: 2px dashed #ccc;
      border-radius: 10px;
      padding: 20px;
      margin: 10px auto;
      max-width: 320px;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      font-size: 1em;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    video {
      max-width: 100%;
      border-radius: 10px;
    }
    img {
      max-width: 100%;
      border-radius: 10px;
    }
    a {
      display: inline-block;
      padding: 10px 15px;
      background: #28a745;
      color: white;
      border-radius: 8px;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <header>🌤 魔法天气播报员</header>

  <!-- 天气展示 -->
  <div id="weather-box">
    <p id="location">正在定位中...</p>
    <p id="weather">天气数据加载中...</p>
    <p id="tips">✨ 等待魔法播报...</p>
  </div>

  <!-- NFC 功能占位 -->
  <div class="section">
    <h3>NFC 功能</h3>
    <div class="placeholder">📱 这里是 NFC 触碰启动的占位区域</div>
  </div>

  <!-- 视频播报 -->
  <div class="section">
    <h3>视频播报</h3>
    <video id="weather-video" controls>
      <source src="video1.mp4" type="video/mp4">
      您的浏览器不支持视频播放
    </video>
  </div>

  <!-- 图片 / AR 占位 -->
  <div class="section">
    <h3>AR 天气动画</h3>
    <img src="1.png" alt="天气图片占位">
    <br><br>
    <!-- 仅 iOS Safari 支持 USDZ AR -->
    <a rel="ar" href="model.usdz">📱 点击进入 AR 模型</a>
  </div>

  <button onclick="reloadWeather()">🔄 刷新天气</button>

  <script>
    const API_KEY = "6b643f91d5b34f74b75d835a3e72377f"; // 替换为你的和风天气 API Key
    const WEATHER_URL = "https://devapi.qweather.com/v7/weather/now";

    // 魔法文案库
    const weatherTips = {
      "晴": ["今天阳光明媚，适合出门走走 🌞", "晴空万里，心情也跟着明亮起来！"],
      "雨": ["记得带伞哦，别让自己淋湿啦 ☔", "小雨滋润大地，空气更清新～"],
      "雪": ["飘雪的日子最浪漫 ❄", "出门注意保暖，赏雪也要注意安全～"],
      "阴": ["阴天有点小忧郁，来杯咖啡提提神 ☁", "天空灰蒙蒙，但心情要明亮～"],
      "默认": ["天气不错，适合任何冒险 ✨", "无论天气如何，今天也要加油！"]
    };

    // 页面加载时获取天气
    window.onload = () => {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(success, error);
      } else {
        document.getElementById("location").innerText = "❌ 当前浏览器不支持定位";
        loadMockWeather();
      }
    };

    function success(pos) {
      const lat = pos.coords.latitude;
      const lon = pos.coords.longitude;
      fetch(`${WEATHER_URL}?location=${lon},${lat}&key=${API_KEY}`)
        .then(res => res.json())
        .then(data => {
          if (data.code === "200") {
            const weather = data.now.text;
            const temp = data.now.temp;
            document.getElementById("location").innerText = `📍 当前坐标：${lat.toFixed(2)}, ${lon.toFixed(2)}`;
            document.getElementById("weather").innerText = `实时天气：${weather}，温度：${temp}℃`;

            // 随机魔法文案
            const tips = weatherTips[weather] || weatherTips["默认"];
            const randomTip = tips[Math.floor(Math.random() * tips.length)];
            document.getElementById("tips").innerText = "🔮 " + randomTip;
          } else {
            loadMockWeather();
          }
        })
        .catch(err => {
          console.error(err);
          loadMockWeather();
        });
    }

    function error() {
      document.getElementById("location").innerText = "❌ 定位失败，使用模拟数据";
      loadMockWeather();
    }

    // 模拟天气数据
    function loadMockWeather() {
      document.getElementById("weather").innerText = "实时天气：晴，温度：26℃";
      const tips = weatherTips["晴"];
      const randomTip = tips[Math.floor(Math.random() * tips.length)];
      document.getElementById("tips").innerText = "🔮 " + randomTip;
    }

    // 刷新按钮
    function reloadWeather() {
      window.location.reload();
    }
  </script>
</body>
</html>
